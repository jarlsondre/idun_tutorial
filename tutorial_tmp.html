<!DOCTYPE html>
<html>
<head>
<title>tutorial.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="idun-tutorial-from-the-perspective-of-a-masters-student">IDUN tutorial from the perspective of a master's student</h1>
<p>This document will contain information about useful techniques in IDUN. This
document was initially created by Aurora Grefsrud, who delivered her master's
thesis in the spring of 2021. In the spring of 2024, Jarl Sondre SÃ¦ther, who was
writing his thesis at the time, expanded the document quite extensively, adding
multiple sections as well as refining some of the existing parts.</p>
<p>The IDUN cluster is a high-performance computational resource provided by NTNU.
Getting access to IDUN means that you have access to a cluster of powerful
computers which provide both storage and computational resources in the form of
computer cores and GPUs. Each computer is known as a node, and each node has
several cores.</p>
<h2 id="accessing-idun-through-the-command-line">Accessing IDUN through the command line</h2>
<p>You can access IDUN through Secure Shell (SHH), which provides a secure
connection to the cluster. To get access, you either have to be on the NTNU
network (e.g. by being on campus) or you have to be connected to it via VPN.
Once you are connected to NTNU, you can access IDUN using the following command:</p>
<pre class="hljs"><code><div>ssh &lt;username&gt;@idun.hpc.ntnu.no
</div></code></pre>
<p>This will ask you for your password, and in typical Unix fashion it will not
display any of the characters that you enter. Press the <code>&lt;enter&gt;</code> key on your
keyboard when you have finished typing your password. An example of this is:</p>
<pre class="hljs"><code><div>$ ssh jssaethe@idun.hpc.ntnu.no
jssaethe@idun.hpc.ntnu.no's password:
</div></code></pre>
<p>This will give you access to a login node, but be careful not to run your
jobs on these nodes. If you have a job that you want to run, make sure to run it
on a compute node. We will get back to how to do this.</p>
<h2 id="adding-ssh-keys-to-avoid-using-password">Adding SSH keys to avoid using password</h2>
<p>Since typing your password every time can be annoying, I would strongly advise
that you add an SSH key. The first thing you do is to generate an SSH key by
typing ssh-keygen. An example of this is:</p>
<pre class="hljs"><code><div>$ ssh-keygen
Generating public/private rsa key pair.
Enter file in which to save the key (/Users/&lt;your username&gt;/.ssh/id_rsa):
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in /Users/&lt;your username&gt;/.ssh/id_rsa
Your public key has been saved in /Users/&lt;your username&gt;/.ssh/id_rsa.pub
The key fingerprint is:
</div></code></pre>
<p>followed by your fingerprint. Notice that you can give it any name you want,
so it might be useful to name something that makes you remember which key it is,
e.g. &quot;NTNU&quot;.</p>
<p>Now you have to add the key to the NTNU server. This can be done by typing the
following command</p>
<pre class="hljs"><code><div>ssh-copy-id -i &lt;path_to_your_key.pub&gt; &lt;username&gt;@idun.hpc.ntnu.no
</div></code></pre>
<p>If your file is in the <code>.ssh</code>directory and it is named <code>ntnu</code>, then you do it
with the following command:</p>
<pre class="hljs"><code><div>ssh-copy-id -i ~/.ssh/ntnu.pub &lt;username&gt;@idun.hpc.ntnu.no
</div></code></pre>
<p>Now you just have to add your key to your <code>ssh-agent</code> and you will be able to
log into the NTNU servers without using your NTNU password. This will be very
helpful if you are using VSCODE as explained in some of the later steps.</p>
<h3 id="adding-the-ssh-key-to-your-keychain-macos">Adding the SSH key to your keychain (MacOS)</h3>
<p>If you want the password you set for your key to be automatically added through
your keychain, then you can create a file at <code>~/.ssh/config</code> or edit your
existing one, and then add the following:</p>
<pre class="hljs"><code><div>Host *
  AddKeysToAgent yes
  UseKeychain yes
</div></code></pre>
<p>Once you have this in your config file, you must add your newly made key with
the command</p>
<pre class="hljs"><code><div>ssh-add -K &lt;path_to_private key&gt;
</div></code></pre>
<p>If the file you entered earlier was <code>.ssh/ntnu</code>, then this will have created two
files, <code>.ssh/ntnu</code>and <code>.ssh/ntnu.pub</code>. In this case, you want to type</p>
<pre class="hljs"><code><div>ssh-add -K .ssh/ntnu
</div></code></pre>
<h2 id="unix-shell-basics">Unix Shell Basics</h2>
<p>Since IDUN is running on Linux, you will have to know a couple of unix commands
to maneuver the cluster in a good way. Notice how some commands also have
additional arguments that can be added, e.g. <code>-la</code>, which are called &quot;flags&quot;.</p>
<h3 id="print-working-directory">Print Working Directory</h3>
<p>The first command you will learn is called <code>pwd</code>, which is short for &quot;print
working directory&quot;. This is used to show where in the file system you are
currently located. An example of the output of this command is:</p>
<pre class="hljs"><code><div>[jssaethe@idun-login1 ~]$ pwd
/cluster/home/jssaethe
</div></code></pre>
<p>This command will often be used to illustrate the other commands in this
document.</p>
<h3 id="list-directoriesfiles">List directories/files</h3>
<p>To see the possible files in a given location/directory, you can type the <code>ls</code>
command. An example of this is:</p>
<pre class="hljs"><code><div>[jssaethe@idun-login1 cluster]$ pwd
/cluster

[jssaethe@idun-login1 cluster]$ ls
apps  apps-r8  home  projects  shared  work
</div></code></pre>
<p>The <code>-l</code> flag will show the output as a list and the <code>-a</code> flag will show all
files, since some files are hidden by default. An example of this is</p>
<pre class="hljs"><code><div>[jssaethe@idun-login1 cluster]$ ls -la
total 264
drwxr-xr-x     9 root    root                 4096 Jan 16 10:47 .
dr-xr-xr-x.   20 root    root                  286 Dec 11 00:54 ..
drwxr-xr-x     5 root    root                 4096 Jan 12 15:03 apps
drwxr-xr-x     5 pavlokh root                 4096 Dec 11 00:47 apps-r8
drwxr-xr-x  1411 root    root               102400 Jan 16 18:40 home
drwxr-xr-x    26 root    root                 4096 Dec 10 16:51 projects
drwsrwsr-x     5 root    itea_lille-support   4096 Sep 18 08:18 shared
drwxr-xr-x  1398 root    root               139264 Jan 17 10:23 work
</div></code></pre>
<h3 id="change-directory">Change directory</h3>
<p>In order to change your location on the cluster, you can use the command <code>cd</code>,
which is short for &quot;change directory&quot;. An example of this is:</p>
<pre class="hljs"><code><div>[jssaethe@idun-login1 cluster]$ pwd
/cluster

[jssaethe@idun-login1 cluster]$ ls
apps  apps-r8  home  projects  shared  work

[jssaethe@idun-login1 cluster]$ cd home
[jssaethe@idun-login1 home]$ pwd
/cluster/home
</div></code></pre>
<h3 id="show-the-content-of-a-file">Show the content of a file</h3>
<p>If you want to view the content of a file, you can type the command <code>cat</code>,
which is short for &quot;concatenate&quot;, followed by the name of the file you want to
see. You cannot edit the file this way. An example of this is:</p>
<pre class="hljs"><code><div>[jssaethe@idun-login1 tutorial]$ ls
test.txt

[jssaethe@idun-login1 tutorial]$ cat test.txt
this is my test file
</div></code></pre>
<h3 id="edit-a-file-in-the-terminal">Edit a file in the terminal</h3>
<p>If you want to edit a file in the terminal, then you can open a terminal text
editor, i.e. an editor that works from the terminal. The two most prominent
text editors that you will find are nano and vim, but if you don't have
a lot of terminal experience then I would recommend nano. To open up this
editor, use the command <code>nano</code> followed by the name of the file you want to open.
An example of this is:</p>
<pre class="hljs"><code><div>[jssaethe@idun-login1 tutorial]$ ls
test.txt

[jssaethe@idun-login1 tutorial]$ nano test.txt
</div></code></pre>
<h3 id="adding-permissions-to-execute-a-file">Adding permissions to execute a file</h3>
<p>Sometimes you don't have the permission to execute a file in Linux, e.g. a
script you have made. In this case, you can use the <code>chmod</code> command to add
permissions to the file. If you want to add the permission to execute the file,
use the flag <code>+x</code>. The command would then look like this:</p>
<pre class="hljs"><code><div>chmod +x &lt;name of your file&gt;
</div></code></pre>
<h3 id="clear-the-terminal">Clear the terminal</h3>
<p>If your terminal becomes cluttered, you can clear the terminal by typing the
command <code>clear</code> or by pressing <code>ctrl + l</code>.</p>
<h3 id="searching-through-a-file">Searching through a file</h3>
<p>You can search through a file using the <code>grep</code> command, followed by the string
you are looking for and then the name of the file. This will scan through the
file line by line and print any lines that contain the string you searched for.
An example of running this command is:</p>
<pre class="hljs"><code><div>[jssaethe@idun-login1 ~]$ cat test.txt
This is my test file
I am a computer science student
I like algorithms
Do you like computer science?

[jssaethe@idun-login1 ~]$ grep computer test.txt
I am a computer science student
Do you like computer science?
</div></code></pre>
<h3 id="chaining-shell-commands-with-redirects-and-pipes">Chaining shell commands with redirects and pipes</h3>
<p>If you want to use your shell in a more efficient manner, you might sometimes
want to use the pipe command, <code>|</code>, or the redirect commands, <code>&gt;</code> and <code>&lt;</code>.
The pipe is used to chain commands, e.g. <code>ls</code> and <code>grep</code>, which sends the output
of <code>ls</code> to the input of <code>grep</code>, while the redirects are used for connecting the
output and input of a file to the output and input of a command. This all
depends on which redirect command you use. An example of a pipe can be:</p>
<pre class="hljs"><code><div>[jssaethe@idun-login1 ~]$ squeue | grep jssaethe
          18915101      GPUQ sys/dash jssaethe  R    2:30:38      1 idun-04-04
</div></code></pre>
<p>where I ask IDUN for the entire queue and then I filter the output based on
whether it contains my username, &quot;jssaethe&quot;. You can see that the only output I
get is the one process with my name. This is obviously a silly example, because
I could have just used <code>-u jssaethe</code> to achieve the same thing, but this would
also work if you were looking for a particular job_name. Thus it highlights the
functionality well.</p>
<p>An example of using redirects can be:</p>
<pre class="hljs"><code><div>cat old_slurm_script.slurm &gt; new_slurm_script.slurm
</div></code></pre>
<p>This command will essentially copy the contents of <code>old_slurm_script.slurm</code> and
put it into the file <code>new_slurm_script.slurm</code>. If the new script file does not
exist, it will be created. This can be very handy if you want a similar script
but only want to change a few details.</p>
<p>An example of using the other redirect is:</p>
<pre class="hljs"><code><div>[jssaethe@idun-login1 ~]$ cat python_script.py
my_variable  = input()
print(&quot;Received the following input:&quot;)
print(my_variable)

[jssaethe@idun-login1 ~]$ cat input.txt
This is my input!

[jssaethe@idun-login1 ~]$ python python_script.py &lt; input.txt
Received the following input:
This is my input!
</div></code></pre>
<p>Here you can see that I am using the contents of <code>input.txt</code> as an input to the
python script, which then prints the input it received. It is a rather silly
script, but it shows some very powerful tools you can use to automate your
workflow quite considerably. The situation I use this in most often is when I
want to test my code with a particular set of inputs. Then I will store my
inputs in the <code>input.txt</code> file, so that I don't have to enter them every time
I want to test my algorithm.</p>
<h2 id="loading-python-versions-and-other-modules">Loading python versions and other modules</h2>
<p>In order to load python, you need to use the module system on IDUN. First, you
can remove all previously loaded modules for your session using the command</p>
<pre class="hljs"><code><div>module purge
</div></code></pre>
<p>Now, you can look through the different modules that exist by typing</p>
<pre class="hljs"><code><div>module avail
</div></code></pre>
<p>If you want an overview that is chunked by type of module, you can type</p>
<pre class="hljs"><code><div>module spider
</div></code></pre>
<p>If you want more information about a specific module, you can type</p>
<pre class="hljs"><code><div>module spider &lt;module name&gt;
</div></code></pre>
<p>For example, if you would like more information about the different pytorch
modules, then you can type</p>
<pre class="hljs"><code><div>module spider pytorch
</div></code></pre>
<p>The most common python module is Anaconda3. use <code>module spider Anaconda3</code> to
find the version you want to use and then load it using <code>module load</code>, e.g.</p>
<pre class="hljs"><code><div>module load Anaconda3/2023.09-0
</div></code></pre>
<p>You can check the the installed Python packages and install new packages using
pip:</p>
<pre class="hljs"><code><div># shows installed packages and their version numbers
pip list

# install new package
pip install package_name --user

# install package with specific version number X.X
pip install package_name==X.X --user
</div></code></pre>
<h2 id="running-jobs">Running jobs</h2>
<p>When you want to run your large project on the cluster you must submit it to
SLURM as a job. It is then queued along with other sumbitted jobs, and will be
run when the computer resources are available. You can get e-mail notifications
for when the job is started, when it is completed or if it fails. More in depth
documentation can be found at the Sigma2 webpage.</p>
<p>The first step is to create a SLURM job script. It is essentially a bash script
with some extra information for SLURM. An example of a functioning</p>
<pre class="hljs"><code><div>#!/bin/sh
#SBATCH --account=&lt;account&gt;       # E.g. &quot;ie-idi&quot; if you belong to IE
#SBATCH --job-name=example_job
#SBATCH --time=0-00:15:00         # format: D-HH:MM:SS

#SBATCH --partition=GPUQ          # Asking for a GPU
#SBATCH --mem=16G                 # Asking for 16GB RAM
#SBATCH --nodes=1
#SBATCH --output=output.txt      # Specifying 'stdout'
#SBATCH --error=output.err        # Specifying 'stderr'

#SBATCH --mail-user=&lt;email&gt;
#SBATCH --mail-type=ALL

WORKDIR=${SLURM_SUBMIT_DIR}
cd ${WORKDIR}
echo &quot;Running from this directory: $SLURM_SUBMIT_DIR&quot;
echo &quot;Name of job: $SLURM_JOB_NAME&quot;
echo &quot;ID of job: $SLURM_JOB_ID&quot;
echo &quot;The job was run on these nodes: $SLURM_JOB_NODELIST&quot;

module purge

# Running your python file
module load Anaconda/2020.07
python &lt;path_to_pythonfile&gt;.py
</div></code></pre>
<p>Let's break down this example. The first line, #!/bin/sh tells the computer that
this is a bash script. The next lines are all commented out, but they are still
read by SLURM and change the environment variables.</p>
<table>
<thead>
<tr>
<th>Item</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>partition</td>
<td>Whether your script needs CPU or GPU.</td>
</tr>
<tr>
<td>account</td>
<td>The billing account connected to running the script</td>
</tr>
<tr>
<td>time</td>
<td>The amount of time allocated for your job. The task fails if your program runs for longer than this time limit.</td>
</tr>
<tr>
<td>nodes</td>
<td>The number of nodes.</td>
</tr>
<tr>
<td>ntasks-per-node</td>
<td>The number of tasks per node.</td>
</tr>
<tr>
<td>mem</td>
<td>The amount of memory allocated for your job. The task fails if your program exceeds this limit.</td>
</tr>
<tr>
<td>job-name</td>
<td>The name of the job.</td>
</tr>
<tr>
<td>output</td>
<td>The file in which to save all printed outputs.</td>
</tr>
<tr>
<td>error</td>
<td>The file in which to save all printed errors.</td>
</tr>
<tr>
<td>mail-user</td>
<td>The email to send notifications to.</td>
</tr>
<tr>
<td>mail-type</td>
<td>Which emails to send.</td>
</tr>
</tbody>
</table>
<h3 id="running-your-slurm-script">Running your SLURM script</h3>
<p>Once you have a script that you want to run, e.g. <code>example_script.slurm</code>, you
can run the script by typing <code>sbatch example_script.slurm</code>. This will start your
script. This is an example of what this looks like:</p>
<pre class="hljs"><code><div>[jssaethe@idun-login1 jssaethe]$ sbatch example_script.slurm
Submitted batch job 18915035
</div></code></pre>
<h3 id="checking-the-slurm-queue">Checking the SLURM queue</h3>
<p>Once you have started your script, you can check whether it has started or not
and/or how long it has been running by using the command <code>squeue</code>. This will
show the entire queue. Therefore, if you only want to see your personal entries
you can add the <code>-u</code> flag, followed by your username. An example is:</p>
<pre class="hljs"><code><div>[jssaethe@idun-login1 jssaethe]$ squeue -u jssaethe
             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)
          18915029      GPUQ example_ jssaethe PD       0:00      1 (Priority)
</div></code></pre>
<h3 id="canceling-your-slurm-job">Canceling your SLURM job</h3>
<p>If you want to cancel your SLURM job, you can do this using the <code>scancel</code>
command, followed by the JOBID of your job. Following the example above, you
would type <code>scancel 18915029</code> to stop the listed job.</p>
<h2 id="setting-up-gpus-to-use-with-pytorch">Setting up GPUs to use with PyTorch</h2>
<p>There are multiple ways of setting up the use of GPUs with PyTorch, but the
method I find to be the easiest is to set up an Anaconda environment and then
installing pytorch on it. Make sure to request a GPU if you would like to see
if this worked, as if you try to run code on the login-nodes or a node without
a GPU then it will obviously not work. You can perform this setup on a
login-node, however. You should only have to do it once.</p>
<ol>
<li>Set up a conda environment: You can do this by loading the conda module and
then creating your environment. You can find tutorials online showing how to
create a conda environment.</li>
<li>Activate your conda environment using <code>conda activate &lt;your environment&gt;</code>.</li>
<li>Install PyTorch, as explained on <a href="https://pytorch.org/">the PyTorch website</a>
by selecting your PyTorch version, &quot;Linux&quot; as operating system, &quot;Conda&quot; as your
package and &quot;Python&quot; as your language. Then you will get a command that looks
something like this:<pre class="hljs"><code><div>conda install pytorch torchvision torchaudio pytorch-cuda=12.1 -c pytorch -c nvidia
</div></code></pre>
</li>
<li>Set your device to GPU. I like doing this with the following command:<pre class="hljs"><code><div>device = torch.device(&quot;cuda&quot; if torch.cuda.is_available() else &quot;cpu&quot;)
print(f&quot;device: {device}&quot;)
</div></code></pre>
</li>
<li>Make sure to move all your models and variables to the device.</li>
<li>Now you can run your code on the IDUN GPUs!</li>
</ol>
<p>It is also possible to set this up by loading the PyTorch Cuda module on IDUN,
but I find the conda setup to be more consistent as you can activate your conda
environment in your slurm files instead of setting up everything for each script
you have.</p>
<h2 id="connect-local-visual-studio-code-to-idun">Connect local Visual Studio Code to IDUN</h2>
<p>It is possible to open a Visual Studio Code session on IDUN, allowing you to
edit files directly on IDUN from a browser window. This, however, can be
tedious as the experience can be quite buggy. Running the debugger is often
problematic, the window often freezes and the interface is somewhat different
from the desktop version. It is, however, possible to access IDUN directly from
your local VSCode. This alleviates most of the problems you encounter and thus
allows you to run notebooks and scripts in a much more seamless fashion. Also
note that you have to be connected to the NTNU network for this to work. The
steps to doing this are:</p>
<h3 id="step-1-ask-for-resources">Step 1: Ask for resources</h3>
<p>The first step is to ask IDUN for resources. This is done the same way you would
start a browser session. You go to <code>https://apps.hpc.ntnu.no/</code>, login and ask
for a &quot;Visual Studio Code Server&quot;. Once you are given access to a node, you
will get the following view under &quot;Home/My Interactive Sessions&quot; on the website.</p>
<p><img src="file:///Users/jarl/Documents/idun_documentation/images/server-allocation.png" alt="Server Allocation"></p>
<p>Instead of clicking &quot;Connect to VS Code&quot;, which will send you to the browser
version, you take note of the host name. In this case, it is
<code>idun-04-08</code>, but it can be different depending on which particular node you
are given.</p>
<h3 id="step-2-setup-ssh-proxy">Step 2: Setup ssh proxy</h3>
<p>In order to access the compute nodes, you first have to login using the login
nodes. This means that you need to setup a proxy jump, so that you access the
compute nodes through the login nodes. The details behind this are not very
important, so do not worry if you do not fully understand this. On MacOS, all
you need to do is to open your ssh config file, usually located at
<code>~/.ssh/config</code>, and then add the following:</p>
<pre class="hljs"><code><div>Host login-node
  HostName idun-login1.hpc.ntnu.no
  User &lt;your NTNU username&gt;

Host compute-node
  HostName &lt;Your allotted compute node, e.g. &quot;idun-04-08&quot;&gt;
  User &lt;your NTNU username&gt;
  ProxyJump login-node
</div></code></pre>
<p>If the file doesn't exist, feel free to create it. Make sure to change the
HostName of the compute node, as well as the user for the login node and the
compute node. An example of how this would look with my username is</p>
<pre class="hljs"><code><div>Host login-node
  HostName idun-login1.hpc.ntnu.no
  User jssaethe

Host compute-node
  HostName idun-04-08
  User jssaethe
  ProxyJump login-node
</div></code></pre>
<h3 id="step-3-connect-with-vscode">Step 3: Connect with VSCode</h3>
<p>Now that you have this setup, you can open VSCode and connect to the compute
node. This is done by pressing the blue button in the bottom right corner of
VSCode, as seen in the image.</p>
<p><img src="file:///Users/jarl/Documents/idun_documentation/images/vscode-corner-button.png" alt="Corner button"></p>
<p>This will open the following menu:</p>
<p><img src="file:///Users/jarl/Documents/idun_documentation/images/vscode-connect-to-host.png" alt="Connect to host"></p>
<p>When you are here, you can click &quot;Connect to Host&quot; or &quot;Connect current window
to Host&quot;, depending on whether you want a new window or not. When you click
one of them, you will get the following if you have done everything correctly:</p>
<p><img src="file:///Users/jarl/Documents/idun_documentation/images/vscode-select-host.png" alt="Select host"></p>
<p>Now, choose &quot;compute-node&quot;. You will be prompted to enter your password quite
a lot of times, possibly as many as eight times, so it can be handy to have
your password in the clipboard or in a password manager, or just using SSH keys
like explained at the top of this tutorial. After typing your
password a couple of times, you will get this screen:</p>
<p><img src="file:///Users/jarl/Documents/idun_documentation/images/vscode-select-folder.png" alt="Select folder"></p>
<p>At this point, choose which folder you want to work in by clicking &quot;open folder&quot;
on the left side. After clicking &quot;OK&quot;, you will have to type your password a
couple of more times, unless you are using SSH keys.</p>
<p>Now you should be connected and ready to work! Any code you run in your window
will now be ran on IDUN's CPUs or GPUs, depending on your selection in step 1.</p>
<h2 id="jupyter-notebook">Jupyter Notebook</h2>
<p>It is possible to run an interactive Jupyter Notebook session hosted on the IDUN servers on your home computer. This is done through SSH tunneling.
Start a jupyter notebook session from the folder you want to work with while logged in to IDUN:</p>
<pre class="hljs"><code><div>cd /lustre1/work/username/foldername
module load Anaconda3/2020.07
jupyter notebook --no-browser
</div></code></pre>
<p>You will get a message like this:</p>
<pre class="hljs"><code><div>To access the notebook, open this file in a browser:
        file:///run/user/1227530/jupyter/nbserver-159660-open.html
    Or copy and paste one of these URLs:
        http://localhost:8890/?token=ff0495955e8663c1f31c2f6bae32da7197127e081142e590
</div></code></pre>
<p>Jupyter Notebook is then hosted on localhost:8890. Note that you might get another port. We want to access this from our own localhost:XXXX to open it in our local browser.
Open a new command line window and log in to the NTNU servers:</p>
<pre class="hljs"><code><div>ssh -X login.stud.ntnu.no -l username
</div></code></pre>
<p>Now open an SSH-tunnel from the NTNU login to the IDUN login. Remember that you may use another login than login1:</p>
<pre class="hljs"><code><div>ssh -L YYYY:localhost:8890 username@idun-login1.hpc.ntnu.no
</div></code></pre>
<p>YYYY can be any available port. Try 8888 for instance, or 1234.
However, we can still not access Jupyter Notebook from our browser, so we must make another tunnel from the NTNU login to our computer. Open a third command line window:</p>
<pre class="hljs"><code><div>ssh -L XXXX:localhost:YYYY username@login.stud.ntnu.no
</div></code></pre>
<p>Now you can copy the link from earlier, and change the port to your chosen port XXXX. Paste that into your browser:
http://localhost:XXXX/?token=ff0495955e8663c1f31c2f6bae32da7197127e081142e590</p>
<p>You should be able to access your files from the IDUN folder you started jupyter notebook from.</p>

</body>
</html>
